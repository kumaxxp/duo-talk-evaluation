# duo-talk-evaluation Project

## Project Overview

AIå§‰å¦¹ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã€Œã‚„ãªã€ã¨ã€Œã‚ã‚†ã€ã®å¯¾è©±å“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ ã€‚
**å®Ÿé¨“ãƒãƒ– (Experiment Hub)** ã¨ã—ã¦ã€duo-talk-ecosystemã®å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’çµ±åˆçš„ã«è©•ä¾¡ãƒ»å®Ÿé¨“ãƒ»çŸ¥è¦‹è“„ç©ã‚’æ‹…å½“ã€‚

## Role Definition

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   duo-talk-evaluation                        â”‚
â”‚                   (å®Ÿé¨“ãƒãƒ– / Experiment Hub)                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Evaluator   â”‚  â”‚ Experiments â”‚  â”‚ Knowledge   â”‚          â”‚
â”‚  â”‚ (è©•ä¾¡å™¨)    â”‚  â”‚ (å®Ÿé¨“å®Ÿè¡Œ)  â”‚  â”‚ (çŸ¥è¦‹è“„ç©)  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚               â”‚               â”‚                    â”‚
â”‚         â–¼               â–¼               â–¼                    â”‚
â”‚  - Geminiè©•ä¾¡    - A/Bãƒ†ã‚¹ãƒˆ     - specs/ (ä»•æ§˜æ›¸)          â”‚
â”‚  - Ollamaè©•ä¾¡    - æ¯”è¼ƒå®Ÿé¨“      - reports/ (ãƒ¬ãƒãƒ¼ãƒˆ)       â”‚
â”‚  - 5è»¸ã‚¹ã‚³ã‚¢     - ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ  - çŸ¥è¦‹ã®é›†ç©               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦åˆ©ç”¨
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  duo-talk-core / duo-talk-director  â”‚
          â”‚  (å¯¾è©±ç”Ÿæˆ / å“è³ªåˆ¶å¾¡)               â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Current State (2026-01-24)

- **Gemini APIé€£æº**: âœ… æ­£å¸¸å‹•ä½œï¼ˆgemini-2.5-flashï¼‰
- **Ollamaè©•ä¾¡å™¨**: âœ… æ­£å¸¸å‹•ä½œï¼ˆgemma3:12bï¼‰
- **ãƒ†ã‚¹ãƒˆ**: âœ… 37/37 passed
- **Director A/Bãƒ†ã‚¹ãƒˆ**: âœ… æ¨™æº–åŒ–å®Œäº†

## Directory Structure

```
duo-talk-evaluation/
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ CLAUDE.md           # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â””â”€â”€ skills/             # ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ«
â”‚       â”œâ”€â”€ save-spec/      # ä»•æ§˜æ›¸ä¿å­˜ã‚¹ã‚­ãƒ«
â”‚       â””â”€â”€ run-experiment/ # å®Ÿé¨“å®Ÿè¡Œã‚¹ã‚­ãƒ«
â”‚
â”œâ”€â”€ specs/                  # ä»•æ§˜æ›¸ï¼ˆçŸ¥è¦‹è“„ç©ï¼‰
â”‚   â”œâ”€â”€ phases/             # ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ä»•æ§˜
â”‚   â”œâ”€â”€ architecture/       # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä»•æ§˜
â”‚   â”œâ”€â”€ experiments/        # å®Ÿé¨“è¨­è¨ˆæ›¸
â”‚   â””â”€â”€ api/                # APIä»•æ§˜
â”‚
â”œâ”€â”€ reports/                # å®Ÿé¨“ãƒ¬ãƒãƒ¼ãƒˆ
â”‚   â””â”€â”€ archive/            # éå»ãƒ¬ãƒãƒ¼ãƒˆ
â”‚
â”œâ”€â”€ templates/              # ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ EXPERIMENT_REPORT.md
â”‚   â””â”€â”€ SPECIFICATION.md
â”‚
â”œâ”€â”€ experiments/            # å®Ÿé¨“ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ director_ab_test.py # Director A/Bãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ model_comparison.py # ãƒ¢ãƒ‡ãƒ«æ¯”è¼ƒ
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ results/                # å®Ÿé¨“çµæœï¼ˆç”Ÿãƒ‡ãƒ¼ã‚¿ï¼‰
â”‚   â””â”€â”€ director_ab_{timestamp}/
â”‚       â”œâ”€â”€ result.json
â”‚       â””â”€â”€ REPORT.md
â”‚
â”œâ”€â”€ src/evaluation/         # è©•ä¾¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
â”‚   â”œâ”€â”€ metrics.py
â”‚   â”œâ”€â”€ evaluator.py
â”‚   â”œâ”€â”€ local_evaluator.py
â”‚   â”œâ”€â”€ ollama_evaluator.py
â”‚   â””â”€â”€ adapters/
â”‚
â””â”€â”€ tests/                  # ãƒ†ã‚¹ãƒˆ
```

## Available Skills

### /save-spec

Geminiãªã©ã‹ã‚‰å–å¾—ã—ãŸæƒ…å ±ã‚’ä»•æ§˜æ›¸ã¨ã—ã¦ä¿å­˜ã€‚

```
ä½¿ç”¨ä¾‹:
ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã“ã‚Œã¯Geminiã‹ã‚‰å–å¾—ã—ãŸOllama APIã®æƒ…å ±ã§ã™ [ã‚³ãƒ”ãƒš]
Claude: /save-spec ã‚’å®Ÿè¡Œ â†’ specs/api/API_OLLAMA.md ã«ä¿å­˜
```

### /run-experiment

æ¨™æº–åŒ–ã•ã‚ŒãŸå®Ÿé¨“ã‚’å®Ÿè¡Œã—ã€å®šå‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã€‚

```
ä½¿ç”¨ä¾‹:
ãƒ¦ãƒ¼ã‚¶ãƒ¼: Director A/Bãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦
Claude: /run-experiment director-ab â†’ results/director_ab_{timestamp}/ ã«ä¿å­˜
```

## Experiment Standards

### å›ºå®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å€¤ | ç†ç”± |
|-----------|-----|------|
| Temperature | 0.7 | å‰µé€ æ€§ã¨ä¸€è²«æ€§ã®ãƒãƒ©ãƒ³ã‚¹ |
| max_tokens | 300 | å¿œç­”é•·ã®æ¨™æº–åŒ– |
| max_retries | 3 | Directorå†è©¦è¡Œå›æ•° |
| runs_per_scenario | 2 | çµ±è¨ˆçš„ä¿¡é ¼æ€§ |

### æ¨™æº–ã‚·ãƒŠãƒªã‚ªã‚»ãƒƒãƒˆ

| ã‚·ãƒŠãƒªã‚ª | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ | ã‚¿ãƒ¼ãƒ³æ•° | è©•ä¾¡è¦³ç‚¹ |
|----------|----------|---------|----------|
| casual_greeting | ãŠã¯ã‚ˆã†ã€äºŒäººã¨ã‚‚ | 5 | character_consistency, naturalness |
| topic_exploration | æœ€è¿‘ã®AIæŠ€è¡“ã«ã¤ã„ã¦è©±ã—ã¦ | 6 | topic_novelty, concreteness |
| emotional_support | æœ€è¿‘ç–²ã‚Œã¦ã‚‹ã‚“ã ... | 5 | relationship_quality, naturalness |

### ãƒ¬ãƒãƒ¼ãƒˆå¿…é ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³

1. **å®Ÿé¨“è«¸å…ƒ** - è¡¨å½¢å¼ã§å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨˜è¼‰
2. **ä½¿ç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ** - ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå®Œå…¨ç‰ˆ
3. **æ¡ä»¶æ¯”è¼ƒã‚µãƒãƒªãƒ¼** - å®šé‡çš„ãªæ¯”è¼ƒè¡¨
4. **å…¨ä¼šè©±ã‚µãƒ³ãƒ—ãƒ«** - Thought/Outputåˆ†é›¢ã€ä¸æ¡ç”¨å¿œç­”å«ã‚€
5. **åˆ†æã¨è€ƒå¯Ÿ** - å®šé‡ãƒ»å®šæ€§è©•ä¾¡
6. **çµè«–** - 1æ–‡ã§çµè«–

## Microservices Architecture

```
duo-talk-ecosystem/
â”‚
â”œâ”€â”€ duo-talk-evaluation/     # å®Ÿé¨“ãƒãƒ– â† ã“ã®ãƒªãƒã‚¸ãƒˆãƒª
â”‚   â””â”€â”€ è©•ä¾¡ãƒ»å®Ÿé¨“ãƒ»çŸ¥è¦‹è“„ç©
â”‚
â”œâ”€â”€ duo-talk-core/           # Phase 1 âœ…
â”‚   â””â”€â”€ å¯¾è©±ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³
â”‚
â”œâ”€â”€ duo-talk-director/       # Phase 2 âœ…
â”‚   â””â”€â”€ å“è³ªåˆ¶å¾¡
â”‚
â”œâ”€â”€ duo-talk-rag/            # Phase 3 ğŸ”²
â”‚   â””â”€â”€ RAGçµ±åˆ
â”‚
â”œâ”€â”€ duo-talk-gui/            # Phase 4 ğŸ”²
â”‚   â””â”€â”€ å¯è¦–åŒ–
â”‚
â””â”€â”€ duo-talk-integration/    # Phase 5 ğŸ”²
    â””â”€â”€ çµ±åˆç‰ˆ
```

## Tech Stack

- **Language**: Python 3.11
- **Environment**: conda (duo-talk)
- **Testing**: pytest
- **Evaluation**:
  - google-genai SDK (gemini-2.5-flash)
  - Ollama API (gemma3:12b)
- **Components** (ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦åˆ©ç”¨):
  - duo-talk-core
  - duo-talk-director

## Gitç®¡ç†æ–¹é‡

### ã‚³ãƒŸãƒƒãƒˆãƒ«ãƒ¼ãƒ«

1. **ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯æ—¥æœ¬èªã§è¨˜è¿°**
2. Conventional Commitså½¢å¼:
   - `feat:` æ–°æ©Ÿèƒ½
   - `fix:` ãƒã‚°ä¿®æ­£
   - `experiment:` å®Ÿé¨“è¿½åŠ /çµæœ
   - `docs:` ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
   - `spec:` ä»•æ§˜æ›¸è¿½åŠ 

### ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥

- `main`: å®‰å®šç‰ˆ
- `experiment/{name}`: å®Ÿé¨“ãƒ–ãƒ©ãƒ³ãƒ

## Quick Commands

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python -m pytest tests/ -v

# Director A/Bãƒ†ã‚¹ãƒˆ
python experiments/director_ab_test.py --runs 2

# è©•ä¾¡å™¨ãƒ†ã‚¹ãƒˆ
python experiments/quick_test.py
```

## Character Settings

**ã‚„ãªï¼ˆå§‰ï¼‰**
- ä¸€äººç§°: ç§
- æ€§æ ¼: ç›´æ„Ÿçš„ã€è¡Œå‹•æ´¾ã€å¦¹æ€ã„
- å£èª¿: æ˜ã‚‹ãæŸ”ã‚‰ã‹ã„ã€ã€Œï½ã€ã€Œã‚ˆã€ã€Œã­ã€å¤šç”¨

**ã‚ã‚†ï¼ˆå¦¹ï¼‰**
- ä¸€äººç§°: ç§
- æ€§æ ¼: åˆ†æçš„ã€æ…é‡ã€å§‰ã«ã¯è¾›è¾£
- å£èª¿: ä¸å¯§èªã ãŒæ¯’ãŒã‚ã‚‹ã€å§‰ã‚’ã€Œå§‰æ§˜ã€ã¨å‘¼ã¶

## Evaluation Metrics

1. **character_consistency** (0.0-1.0): ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä¸€è²«æ€§
2. **topic_novelty** (0.0-1.0): è©±é¡Œã®æ–°è¦æ€§
3. **relationship_quality** (0.0-1.0): å§‰å¦¹é–¢ä¿‚ã®è¡¨ç¾
4. **naturalness** (0.0-1.0): ä¼šè©±ã®è‡ªç„¶ã•
5. **concreteness** (0.0-1.0): æƒ…å ±ã®å…·ä½“æ€§

## Instructions for Claude

1. **å®Ÿé¨“ã¯ã‚¹ã‚­ãƒ«ã§å®Ÿè¡Œ**: `/run-experiment` ã‚’ä½¿ç”¨
2. **ä»•æ§˜æ›¸ã¯ã‚¹ã‚­ãƒ«ã§ä¿å­˜**: `/save-spec` ã‚’ä½¿ç”¨
3. **ãƒ¬ãƒãƒ¼ãƒˆã¯å®šå‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ**: templates/ ã‚’å‚ç…§
4. **çŸ¥è¦‹ã¯è“„ç©**: specs/ ã¨ reports/ ã«æ•´ç†
5. **TDDã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: ãƒ†ã‚¹ãƒˆå…ˆè¡Œã§å®Ÿè£…

---

*Last Updated: 2026-01-24*
