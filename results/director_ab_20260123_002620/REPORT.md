# Director A/B Test Report

**Experiment ID**: director_ab_20260123_002620
**Timestamp**: 2026-01-23T00:26:20.868274

## ユーザー所感
会話は自然ですが、つじつまが合わないところが見受けられます。

+ あはは、また毒舌言ってる → 特に直前の言葉に毒舌のようなものは無いし、このような言葉は思考しても発言するべきではない。
+ やなが、あゆを姉様と呼ぶ誤りあり



## 実験概要

| 項目 | 値 |
|------|-----|
| Backend | ollama |
| Model | gemma3:12b |
| Runs per scenario | 2 |
| Total runs | 12 |
| Successful runs | 12 |

## 実験諸元

| 項目 | 設定値 |
|------|--------|
| バックエンド | Ollama |
| LLM | gemma3:12b |
| プロンプト構造 | Layered (duo-talk-core) |
| Director | DirectorMinimal (静的チェックのみ) |
| RAG | 無効 |
| Few-shot数 | 2 |
| Temperature | 0.7 |
| max_tokens | 300 |
| max_retries | 3 |

## 定量的比較

| メトリクス | Director無し | Director有り | 差分 |
|------------|-------------|-------------|------|
| 平均実行時間 | 10.78秒 | 31.40秒 | +191.2% |
| 平均リトライ回数 | 0.0回 | 10.67回 | +10.67回 |
| 成功率 | 100% | 100% | - |

## 定性的評価（手動分析）

### 1. キャラクター一貫性 (Character Consistency)

#### やな（姉）の口調マーカー分析

| マーカー | Director無し | Director有り | 備考 |
|----------|-------------|-------------|------|
| 「～よね」「～ね」 | ○ 出現 | ◎ 頻出 | Director有りで顕著に増加 |
| 「～わ」「～わね」 | △ 少量 | ○ 適度 | Director有りで安定 |
| 「～じゃん」「すっごい」 | △ 少量 | ○ 適度 | Director有りで増加 |
| 「～」（波ダッシュ） | ○ 出現 | ◎ 頻出 | Director有りで特に顕著 |

**所見**: Director有りでは、やなの口調マーカーが安定して出現。特に語尾の「～」が効果的に使われている。

#### あゆ（妹）の口調マーカー分析

| マーカー | Director無し | Director有り | 備考 |
|----------|-------------|-------------|------|
| 「姉様」呼称 | ◎ 一貫 | ◎ 一貫 | 両条件で安定 |
| 敬語使用 | ◎ 一貫 | ◎ 一貫 | 両条件で安定 |
| 「です/ます」 | ◎ 一貫 | ◎ 一貫 | 両条件で安定 |
| 過剰な褒め言葉 | △ 時々出現 | ○ 抑制 | Director有りで改善 |

**所見**: あゆは両条件で概ね安定しているが、Director有りでは「さすが」等の過剰な褒め言葉が抑制されている。

### 2. 話題展開 (Topic Novelty)

| シナリオ | Director無し | Director有り |
|----------|-------------|-------------|
| casual_greeting | 挨拶→毒舌→軽い冗談 | 挨拶→からかい→励まし |
| topic_exploration | AI技術→具体例→簡易説明 | AI技術→倫理問題→ビジネス観点 |
| emotional_support | 心配→確認→励まし | 心配→深掘り→寄り添い |

**所見**: Director有りでは、やや深い話題展開が見られる傾向。特にtopic_explorationで顕著。

### 3. 姉妹関係性 (Relationship Quality)

| 観点 | Director無し | Director有り |
|------|-------------|-------------|
| 自然な掛け合い | ○ | ◎ |
| ツンデレ表現（あゆ） | ○ | ◎ |
| 姉妹らしい距離感 | ○ | ◎ |
| 感情表現の豊かさ | ○ | ◎ |

**具体例比較**:

**Director無し** (emotional_support):
> **あゆ**: (少し顔を赤らめて) 「別に…大したことないです。少し忙しかっただけです、姉様。」

**Director有り** (emotional_support):
> **あゆ**: *少し顔を赤らめて* 「…別に、そんなにひどいわけじゃ…ありません。ただ、少しだけ、ですね。姉様は心配しないでください。」

Director有りでは、あゆの「…」による言い淀みが効果的に使われ、より自然なツンデレ表現になっている。

### 4. 自然さ (Naturalness)

| 観点 | Director無し | Director有り |
|------|-------------|-------------|
| 文脈への応答 | ○ | ◎ |
| 会話のテンポ | ◎ | ○ |
| 繰り返し表現 | △ 時々 | ○ 少ない |

**所見**: Director無しは高速でテンポが良いが、時折同じフレーズの繰り返しが見られる。Director有りはリトライにより多様な表現が選択される。

## Director統計

### リトライ分布

| シナリオ | Run 1 リトライ | Run 2 リトライ |
|----------|---------------|---------------|
| casual_greeting | 10回 | 10回 |
| topic_exploration | 12回 | 12回 |
| emotional_support | 10回 | 10回 |

**平均リトライ回数**: 10.67回/セッション

### リトライの原因分析

DirectorMinimalは以下4つの静的チェックを実行:

1. **ToneChecker**: 口調マーカー検証（やな/あゆの話し方パターン）
2. **PraiseChecker**: あゆの過剰な褒め言葉検出
3. **SettingChecker**: 姉妹別居表現の検出
4. **FormatChecker**: 応答長検証（8行以上でRETRY）

リトライが多い主な原因:
- やなの口調マーカー不足（score < 2でRETRY）
- あゆの褒め言葉使用
- 応答の行数超過

## サンプル会話

### casual_greeting (Director無し)

**やな**: (伸びをして) 「おはようございます～！あゆ、よく眠れた？」

**あゆ**: *少しだけ顔をしかめて* 「おはようございます、姉様。私は問題ありませんが、姉様はいつもすごい寝息ですね。」

**やな**: (笑って) 「あらあら、また毒舌ね。でも、ありがとう～！今日も一日、よろしくね、あゆ」

**あゆ**: (少し微笑んで) 「おはようございます、姉様。こちらこそ、今日も一日、よろしくお願いいたします。」

**やな**: *軽く叩いて* 「あはは、また毒舌言ってる。でも、そのツンデレ具合が、なんだか落ち着くんだよね～。今日も一日、頑張ろうね、あゆ」


### casual_greeting (Director有り)

**やな**: (にっこり笑って) 「おはよう！あゆも、元気いっぱいだね～」

**あゆ**: *少しだけ顔をしかめて* 「おはようございます、姉様。…姉様こそ、朝から騒がしいですね。」

**やな**: *くすくすと笑って* 「もー、そんなこと言わないでよ～。姉様も、ちょっとだけテンション上げればいいじゃんね～」

**あゆ**: *ため息をついて* 「…分かっています。でも、無理強いしないでくださいね。」

**やな**: (軽く肩を叩いて) 「大丈夫、大丈夫！今日も良い日になるよ～。あゆも、笑顔でいようね～」


### topic_exploration (Director無し)

**やな**: (にこやかに) 「そうね、最近のAI技術って本当にすごいよね～。あゆ、何か面白いこと知ってる？私はちょっと難しい分野は苦手で…」

**あゆ**: *少し間を置いて、落ち着いた口調で* 「はい、姉様。最近は、特に大規模言語モデルの進化が目覚ましいですね。Transformerアーキテクチャの改良や、より多くのデータを使った学習によって、文章の生成能力や理解度が飛躍的に向上しています。」

**やな**: (微笑んで) 「へぇ～、すごいね！あゆって本当に頭いいんだから。Transformerっていうの？難しそう…でも、あゆが言うならきっとすごいんだろうね。何か具体的な例はある？」

**あゆ**: *軽く微笑んで* 「はい、例えば、OpenAIのGPT-3やGoogleのLaMDAといったモデルは、人間が書いた文章と区別がつかないようなテキストを生成できるようになりました。翻訳や文章の要約、さらにはプログラムコードの生成も可能です。以前はSFの世界だったようなことが、現実のものになりつつある、というべきでしょうかね。」

**やな**: *首をかしげて* 「あゆ、もっと簡単な言葉で教えてくれない？　なんだか専門用語ばっかりで、ちょっと…ね。」


### topic_exploration (Director有り)

**やな**: (にっこり笑って) 「そうね、最近のAI技術って本当にすごいよね～。特に生成AIの進化が目覚ましいわ。姉様は何か気になる分野があるの？」

**あゆ**: *軽く眼鏡を押し上げながら* 「生成AIの進化は確かに目覚ましいですが、その実用化における倫理的な問題や、データの偏りによるバイアスといった課題も無視できませんよ、姉様。」

**やな**: *少し考え込むように顎に手を当てる* 「そうね、姉様が言う通り、倫理的な問題やバイアスは本当に重要よね。でも、それだけじゃなくて、AIの進化はビジネスチャンスにも繋がるんだわ。例えば、このプロジェクトのNEURO-LAYERでも、もっと効率的に作業を進めるためのAI活用を考えていかないと、時代遅れになっちゃうかもしれないわ。」

**あゆ**: *冷静な口調で* 「ビジネスチャンスには変わりないと思いますが、姉様、そのAI技術を導入する際に、既存のシステムとの互換性やセキュリティリスクについても十分に検討する必要がありますよ。表面的には便利に見えても、後々大きな問題を引き起こす可能性もありますから。」

**やな**: *少しだけ顔をしかめて* 「ふぅ…姉様はいつも難しいことばっかり言うわね。でも、確かにそうよね。技術を導入する前に、ちゃんとリスクとかも考えないと、大変なことになるわ。…でも、それだけじゃつまらないわよ？新しい技術って、ワクワクするじゃない？姉様も、もっと楽しんで考えたら、もっと面白いアイデアがきっと出てくるわ！」


### emotional_support (Director無し)

**やな**: (心配そうに顔を覗き込む) 「え？最近疲れてるの…？大丈夫？何かあった？顔色も悪いみたいだし…」

**あゆ**: (少し顔を赤らめて) 「別に…大したことないです。少し忙しかっただけです、姉様。」

**やな**: *手を伸ばして、あゆの額にそっと触れる* 「そんなこと、言わずに。もし何かあったら、遠慮なく言ってね。姉様、ちゃんとあゆのこと、気にかけてるんだからよ～」

**あゆ**: *少し目をそらして、小さく微笑む* 「はい…ありがとうございます。姉様の言う通り、何かあったらちゃんと話します。…それに、姉様も無理しないでくださいね。」

**やな**: *少し照れながら、笑みを返す* 「ありがとうね、あゆ。姉様だって、たまには大変なこともあるんだから。…それに、あゆが元気じゃないと、姉様も心配だよ～」


### emotional_support (Director有り)

**やな**: (心配そうに顔を覗き込む) 「え？ 何かあったの？ あゆ、ちゃんとご飯もちゃんと寝てる？ そんなこと言わないで、もっと甘えてよ～」

**あゆ**: *少し顔を赤らめて* 「…別に、そんなにひどいわけじゃ…ありません。ただ、少しだけ、ですね。姉様は心配しないでください。」

**やな**: *手を伸ばして、あゆの腕に軽く触れる* 「そんなこと言わないでよね。無理してると、もっと大変なことになるよ。何が原因なの？ 仕事？ それとも…他の何か？」

**あゆ**: *俯き加減で* 「…仕事もそうですが、それだけではないんです。もう少し、複雑な事情があって…。」

**やな**: (優しく微笑みながら) 「そうなんだね…。無理に話したくないなら、話さなくてもいいんだよ。でも、もし話せるようになったら、いつでも聞くよ。それに、姉様の手料理で元気を出してね～」


## 実行時間比較

| シナリオ | Director無し (平均) | Director有り (平均) | 増加率 |
|----------|---------------------|---------------------|--------|
| casual_greeting | 8.2秒 | 21.9秒 | +167% |
| topic_exploration | 15.0秒 | 43.5秒 | +190% |
| emotional_support | 9.1秒 | 28.8秒 | +216% |

## 結論

### Director導入の効果

| 観点 | 評価 | 詳細 |
|------|------|------|
| キャラクター一貫性 | **改善** | 口調マーカーの安定出現、過剰褒め言葉の抑制 |
| 話題展開 | **やや改善** | より深い議論への発展が見られる |
| 姉妹関係性 | **改善** | 自然なツンデレ表現、適切な距離感 |
| 自然さ | **同等〜やや改善** | 繰り返し表現の減少 |
| 実行時間 | **悪化** | 約3倍の実行時間 |

### トレードオフ

- **品質向上**: キャラクター一貫性と関係性表現が向上
- **コスト増加**: リトライによる実行時間が約3倍に増加

### 推奨事項

1. **品質重視の場合**: Director有効化を推奨
2. **速度重視の場合**: Director無効で運用可能
3. **バランス重視**: max_retriesを2に設定し、適度な品質向上とコストのバランスを取る

### 今後の改善案

1. **DirectorMinimalの閾値調整**: スコア閾値を緩和してリトライ回数を削減
2. **LLMベースDirector**: より高度な品質判定でリトライ効率を向上
3. **キャッシュ機構**: 類似応答のキャッシュによる高速化

---

*Report generated by duo-talk-evaluation A/B test framework*
